<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IPL Admin Panel</title>
<style>
body{font-family:sans-serif;margin:0;padding:0;background:#f0f0f0;}
.container{max-width:900px;margin:20px auto;padding:20px;background:#fff;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.2);}
header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;background:#333545;color:#fff;padding:10px;border-radius:10px 10px 0 0;}
header h3{margin:0;font-size:16px;}
header button{padding:6px 12px;background:#f84464;color:#fff;border:none;border-radius:5px;cursor:pointer;margin-top:5px;}
header button:hover{background:#c4242b;}
form input,form button,form label{padding:10px;margin:5px 0;border-radius:5px;border:1px solid #ccc;font-size:14px;width:100%;box-sizing:border-box;}
form button{background:#f84464;color:#fff;border:none;cursor:pointer;}
form button:hover{background:#c4242b;}
table{width:100%;border-collapse:collapse;margin-top:20px;font-size:12px;}
th,td{border:1px solid #ccc;padding:8px;text-align:center;}
img.preview{width:50px;height:50px;object-fit:contain;border-radius:5px;}
button.edit{background:#4caf50;color:#fff;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;font-size:12px;}
button.edit:hover{background:#388e3c;}
button.delete{background:#f44336;color:#fff;border:none;padding:5px 10px;border-radius:5px;font-size:12px;}
button.delete:hover{background:#c4242b;}
#loginBox{background:#fff;padding:20px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.2);width:90%;max-width:350px;margin:50px auto;text-align:center;}
#loginBox input{width:100%;padding:10px;margin:10px 0;border-radius:6px;border:1px solid #ccc;}
#loginBox button{width:100%;padding:11px;background:#f84464;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:16px;}
#loginBox button:hover{background:#c4242b;}
input[type="text"][id$="_url"] { background: #ffebee; border-color: #f84464; }
</style>
</head>
<body>

<!-- LOGIN BOX -->
<div id="loginBox">
<h2>Admin Login</h2>
<input type="text" id="username" placeholder="Phone / Username">
<input type="password" id="password" placeholder="Password">
<button type="button" onclick="login()">Login</button>
<p style="font-size:12px;color:#666;margin-top:10px;">Demo: <strong>7627055204</strong> / <strong>Pooja2005</strong></p>
</div>

<!-- DASHBOARD -->
<div class="container" id="dashboard" style="display:none;">
<header>
<h3>Admin Dashboard - <span id="adminUser"></span></h3>
<button onclick="logout()">Logout</button>
</header>

<h2>Update Banner</h2>
<form id="bannerForm">
<label>Upload Banner Image:</label>
<input type="file" id="bannerInput" accept="image/*">
<img id="bannerPreview" class="preview" style="display:none;"> 
<button type="submit">Save Banner</button>
</form>

<h2>Update IPL Logo</h2>
<form id="logoForm">
<label>Upload IPL/Tournament Logo:</label>
<input type="file" id="logoInput" accept="image/*">
<img id="logoPreview" class="preview" style="display:none;"> 
<button type="submit">Save Logo</button>
</form>

<h2>Manage Matches</h2>
<form id="matchForm">
<input type="text" id="teams" placeholder="Team1 vs Team2" required>
<input type="date" id="date" required>
<input type="time" id="time" required>
<input type="text" id="stadium" placeholder="Stadium" required>

<label>Team1 Image (Upload or URL):</label>
<input type="file" id="img1_file" accept="image/*" onchange="previewImage(this,'preview1')">
<input type="text" id="img1_url" placeholder="Paste Image URL for Team 1">

<label>Team2 Image (Upload or URL):</label>
<input type="file" id="img2_file" accept="image/*" onchange="previewImage(this,'preview2')">
<input type="text" id="img2_url" placeholder="Paste Image URL for Team 2">

<img id="preview1" class="preview" style="display:none;"> 
<img id="preview2" class="preview" style="display:none;"> 
<button type="submit">Save Match</button>
</form>

<table>
<thead>
<tr>
<th>#</th><th>Teams</th><th>Date</th><th>Time</th><th>Stadium</th><th>Team1 Img</th><th>Team2 Img</th><th>Actions</th>
</tr>
</thead>
<tbody id="matchesTable"></tbody>
</table>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>
// --- Firebase Config ---
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "pl-project-f9be7.firebaseapp.com",
  databaseURL: "https://pl-project-f9be7-default-rtdb.firebaseio.com",
  projectId: "pl-project-f9be7",
  storageBucket: "pl-project-f9be7.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// --- Admin Credentials ---
const ADMIN_USER = "7627055204";
const ADMIN_PASS = "Pooja2005";
let editKey = null;

// --- Login & Logout ---
function login(){
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value.trim();
  if(u===ADMIN_USER && p===ADMIN_PASS){
    localStorage.setItem("isAdmin","true");
    showDashboard();
  } else alert("Invalid username or password");
}

function logout(){
  localStorage.removeItem("isAdmin");
  document.getElementById("dashboard").style.display="none";
  document.getElementById("loginBox").style.display="block";
}

// --- Image Preview ---
function previewImage(input, previewId){
  const preview = document.getElementById(previewId);
  if(input.files[0]){
    const reader = new FileReader();
    reader.onload = ()=>{preview.src=reader.result; preview.style.display="inline-block";};
    reader.readAsDataURL(input.files[0]);
  } else if(input.value.trim()){ preview.src=input.value.trim(); preview.style.display="inline-block"; }
  else { preview.src=""; preview.style.display="none"; }
}

// --- Save Banner ---
document.getElementById("bannerForm").addEventListener("submit", async (e)=>{
  e.preventDefault();
  const file = document.getElementById("bannerInput").files[0];
  if(!file){ alert("Select a banner image"); return; }
  const reader = new FileReader();
  reader.onload = ()=>{
    db.ref("settings/banner").set(reader.result).then(()=>alert("Banner saved!"));
  };
  reader.readAsDataURL(file);
});

// --- Save IPL Logo ---
document.getElementById("logoForm").addEventListener("submit", async (e)=>{
  e.preventDefault();
  const file = document.getElementById("logoInput").files[0];
  if(!file){ alert("Select a logo image"); return; }
  const reader = new FileReader();
  reader.onload = ()=>{
    db.ref("settings/iplLogo").set(reader.result).then(()=>alert("Logo saved!"));
  };
  reader.readAsDataURL(file);
});

// --- Save Matches ---
async function saveMatch(e){
  e.preventDefault();
  const teams = document.getElementById("teams").value.trim();
  const date = document.getElementById("date").value;
  const time = document.getElementById("time").value;
  const stadium = document.getElementById("stadium").value.trim();
  if(!teams||!date||!time||!stadium){ alert("Fill all fields"); return; }

  let img1 = document.getElementById("img1_url").value.trim();
  let img2 = document.getElementById("img2_url").value.trim();

  const convertFileToBase64 = (file) => new Promise((res,rej)=>{
    const reader = new FileReader();
    reader.onload=()=>res(reader.result);
    reader.onerror=err=>rej(err);
    reader.readAsDataURL(file);
  });

  if(document.getElementById("img1_file").files[0])
    img1 = await convertFileToBase64(document.getElementById("img1_file").files[0]);
  if(document.getElementById("img2_file").files[0])
    img2 = await convertFileToBase64(document.getElementById("img2_file").files[0]);

  const matchData = {teams,date,time,stadium,img1,img2};

  if(editKey){ await db.ref("matches/"+editKey).set(matchData); editKey=null; }
  else await db.ref("matches").push(matchData);

  document.getElementById("matchForm").reset();
  renderTable();
}

// --- Render Matches ---
function renderTable(){
  const tableBody = document.getElementById("matchesTable");
  tableBody.innerHTML="";
  db.ref("matches").once("value").then(snapshot=>{
    const data = snapshot.val();
    if(!data){ tableBody.innerHTML="<tr><td colspan='8'>No matches added</td></tr>"; return; }
    let i=1;
    for(const key in data){
      const m = data[key];
      tableBody.innerHTML += `<tr>
      <td>${i}</td><td>${m.teams}</td><td>${m.date}</td><td>${m.time}</td><td>${m.stadium}</td>
      <td><img src="${m.img1}" class="preview"></td><td><img src="${m.img2}" class="preview"></td>
      <td><button onclick="editMatch('${key}')">Edit</button>
          <button onclick="deleteMatch('${key}')">Delete</button></td></tr>`;
      i++;
    }
  });
}

// --- Edit/Delete ---
function editMatch(key){
  editKey = key;
  db.ref("matches/"+key).once("value").then(snapshot=>{
    const m = snapshot.val();
    document.getElementById("teams").value = m.teams;
    document.getElementById("date").value = m.date;
    document.getElementById("time").value = m.time;
    document.getElementById("stadium").value = m.stadium;
    document.getElementById("img1_url").value = m.img1;
    document.getElementById("img2_url").value = m.img2;
    document.getElementById("preview1").src = m.img1; document.getElementById("preview1").style.display="inline-block";
    document.getElementById("preview2").src = m.img2; document.getElementById("preview2").style.display="inline-block";
  });
}

function deleteMatch(key){ if(confirm("Delete this match?")) db.ref("matches/"+key).remove().then(()=>renderTable()); }

// --- Show Dashboard ---
function showDashboard(){
  document.getElementById("loginBox").style.display="none";
  document.getElementById("dashboard").style.display="block";
  document.getElementById("adminUser").textContent="Admin";
  renderTable();
}

// --- Login Check ---
document.addEventListener("DOMContentLoaded", ()=>{
  if(localStorage.getItem("isAdmin")==="true") showDashboard();
  document.getElementById("matchForm").addEventListener("submit", saveMatch);
});
</script>
</body>
</html>
